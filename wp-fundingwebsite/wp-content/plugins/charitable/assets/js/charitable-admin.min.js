/*!  1.6.14 2019-04-04 22:05 */

CHARITABLE_ADMIN=window.CHARITABLE_ADMIN||{},function(t,a){if(a.fn.datepicker){t.Datepicker=function(t){this.$el=t,options={dateFormat:"MM d, yy",minDate:this.$el.data("min-date")||"",beforeShow:function(t,e){a("#ui-datepicker-div").addClass("charitable-datepicker-table")}},this.$el.datepicker(options),this.$el.data("date")&&this.$el.datepicker("setDate",this.$el.data("date")),this.$el.data("min-date")&&this.$el.datepicker("option","minDate",this.$el.data("min-date"))}}}(CHARITABLE_ADMIN,jQuery),function(t,r){t.Settings=function(t){var o=[];show_setting=function(t,e){var a,i="!"===t[0],n=i?t.slice(1):t;return a="checked"===n?e.is(":checked"):"selected"===n?e.selected():e.val()===n,i?!a:a},toggle_setting=function(t,e){var a,i,n=(i=(a=t).parents("tr")).length?i.first():a,o=get_setting_value(t),r=show_setting(o,e);n.toggle(r)},get_setting_value=function(t){var e=t.data("trigger-value");return void 0===e&&(e=t.data("show-only-if-value")),e},toggle_options=function(t,e){var a,i=e.val(),n=t.data("trigger-value");("radio"!==e.attr("type")||e.prop("checked"))&&n.hasOwnProperty(i)&&(a=n[i],t.find("input").each(function(){var t=r(this),e=!(t.val()in a);e&&t.prop("checked",!1),t.prop("disabled",e).trigger("change")}))},get_trigger_id=function(t){var e=t.data("trigger-key");return void 0===e&&(e="#"+t.data("show-only-if-key")),e},get_trigger=function(t){return"#"===t[0]?r(t):r("[name="+t+"]")},get_change_type=function(t){var e=t.data("trigger-change-type");return void 0===e&&(e="visibility"),e},on_change=function(){var t,e=r(this),a=e.data("trigger_idx");for(idx in a)if(a.hasOwnProperty(idx))for(setting_key in t=o[idx].settings)if(t.hasOwnProperty(setting_key)){var i=t[setting_key],n=get_change_type(i);"visibility"===n?toggle_setting(i,e):"options"===n&&toggle_options(i,e)}},this.$el=t;var a=0;for(a in this.$el.find("[data-trigger-key],[data-show-only-if-key]").each(function(){var t=r(this),e=get_trigger_id(t);o[e],void 0===o[e]&&(o[a]={trigger_id:e,settings:[]}),o[a].settings.push(t),a+=1}),o)if(o.hasOwnProperty(a)){var e=get_trigger(o[a].trigger_id),i=e.data("trigger_idx");void 0===i&&(i=[]),i.push(a),e.data("trigger_idx",i),e.on("change",on_change),e.trigger("change")}}}(CHARITABLE_ADMIN,jQuery),function(r){var c=function(){var t=r("#campaign_allow_custom_donations"),e=r(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)"),a=1<e.length||!1===e.first().hasClass("no-suggested-amounts");t.prop("disabled",!a),a||t.prop("checked",!0)},s=function(){r(".charitable-campaign-suggested-donations tbody").each(function(){r(this).children("tr").not(".no-suggested-amounts .to-copy").each(function(e){r(this).data("index",e),r(this).find("input").each(function(t){this.name=this.name.replace(/(\[\d\])/,"["+e+"]")})})})},t=function(){if("undefined"!=typeof accounting){r("body").on("change",".currency-input",function(){var t,e,a=(t=r(this).val(),Math.abs(parseFloat(accounting.unformat(t,CHARITABLE.currency_format_decimal_sep))));0<r.trim(a)&&r(this).val((e=a,accounting.formatMoney(e,{symbol:"",decimal:CHARITABLE.currency_format_decimal_sep,thousand:CHARITABLE.currency_format_thousand_sep,precision:CHARITABLE.currency_format_num_decimals,format:CHARITABLE.currency_format}).trim()))}),r(".currency-input").trigger("change")}};r(document).ready(function(){var e,a,i,n,o;CHARITABLE_ADMIN.Datepicker&&r(".charitable-datepicker").each(function(){CHARITABLE_ADMIN.Datepicker(r(this))}),r("#charitable-settings, body.post-type-campaign form#post, body.post-type-donation form#post").each(function(){CHARITABLE_ADMIN.Settings(r(this))}),r("body.post-type-campaign .handlediv, body.post-type-donation .handlediv").remove(),r("body.post-type-campaign .hndle, body.post-type-donation .hndle").removeClass("hndle ui-sortable-handle").addClass("postbox-title"),function(){var t=r("#charitable-campaign-advanced-metabox");t.tabs();var e=t.find(".charitable-tabs").height();t.find(".ui-tabs-panel").each(function(){r(this).css("min-height",e)})}(),r(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(t,e){s()}}),c(),r("[data-charitable-action]").on("click",function(t){var e=r(this).data("charitable-args")||{},a="charitable-"+r(this).data("charitable-action");return r.post(ajaxurl,{action:a,data:e},function(t){console.log("Response: "+t)}),!1}),r("[data-charitable-toggle]").on("click",function(t){var e=r(this).data("charitable-toggle"),a=r(this).attr("data-charitable-toggle-text");return a&&a.length&&(r(this).attr("data-charitable-toggle-text",r(this).text()),r(this).text(a)),r("#"+e).toggle(),!1}),(e=r("#charitable_dashboard_donations")).length&&r.ajax({type:"GET",data:{action:"charitable_load_dashboard_donations_widget"},url:ajaxurl,success:function(t){e.find(".inside").html(t)}}),r("#campaign_end_date").on("change",function(){var t=r(this),e=t.val(),a=t.siblings(".charitable-end-time"),i=t.siblings("#campaign_end_time");""!==e&&e?(a.text("@ 23:59 PM").show(),i.val("23:59:59")):(a.hide(),i.val(0))}),(o=r(".charitable-actions-form-wrapper")).length&&(a=o.find(".charitable-action-select"),i=o.find(".charitable-actions-submit"),n=i.find("button"),i.hide(),a.on("change",function(){var e=a.val(),t=a.find("option:selected").data("button-text");""!==e?(o.find(".charitable-action-fields").each(function(){var t=r(this);t.toggle(e===t.data("type"))}),t?n.text(t):n.text(n.prop("title")),i.show()):i.hide()})),t(),r("[data-charitable-add-row]").on("click",function(){var t,e,a;return"suggested-amount"===r(this).data("charitable-add-row")&&(t=r(this),e=t.closest(".charitable-campaign-suggested-donations").find("tbody"),a=e.find("tr.to-copy").clone().removeClass("to-copy hidden"),e.find(".no-suggested-amounts").hide(),e.append(a),s(),c()),!1}),r(".charitable-campaign-suggested-donations").on("click",".charitable-delete-row",function(){return console.log("clicked"),function(t){console.log(t),t.closest("tr").remove();var e=t.closest(".charitable-campaign-suggested-donations").find("tbody");1==e.find("tr:not(.to-copy)").length&&e.find(".no-suggested-amounts").removeClass("hidden").show(),s(),c()}(r(this)),!1}),r("body").on("click","[data-campaign-benefactor-delete]",function(){var e=r(this).parents(".charitable-benefactor"),t={action:"charitable_delete_benefactor",benefactor_id:r(this).data("campaign-benefactor-delete"),nonce:r(this).data("nonce")};return r.ajax({type:"POST",data:t,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(t){t.deleted&&e.remove()}}).fail(function(t){window.console&&window.console.log&&(console.log("failture"),console.log(t))}),!1}),r("#change-donation-status").on("change",function(){r(this).parents("form").submit()})})}(jQuery);